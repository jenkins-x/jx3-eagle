apiVersion: jenkins.io/v1
kind: Scheduler
metadata:
  labels:
    app.kubernetes.io/managed-by: Helm
    gitops.jenkins-x.io/pipeline: 'namespaces'
  name: jx3-versions-scheduler
  namespace: jx
spec:
  plugins:
    entries:
      - label
  postsubmits:
    entries:
      - agent: tekton
        branches:
          entries:
            - master
        context: ""
        name: release
    replace: true
  presubmits:
    entries:
      - agent: tekton
        alwaysRun: true
        context: gke
        name: gke
        queries:
          - labels:
              entries:
                - approved
                - person-approved
                - lgtm
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
          - labels:
              entries:
                - updatebot
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
                - needs-security-review
        report: true
        rerunCommand: /test gke
        trigger: (?m)^/test( default| all| gke),?(s+|$)
      - agent: tekton
        alwaysRun: false
        context: gsm
        name: gsm
        queries:
          - labels:
              entries:
                - approved
                - lgtm
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
          - labels:
              entries:
                - updatebot
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
                - needs-security-review
        report: true
        rerunCommand: /test gsm
        trigger: (?m)^/test( all| gsm),?(s+|$)
      - agent: tekton
        alwaysRun: false
        context: istio
        name: istio
        queries:
          - labels:
              entries:
                - approved
                - lgtm
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
          - labels:
              entries:
                - updatebot
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
                - needs-security-review
        report: true
        rerunCommand: /test istio
        trigger: (?m)^/test( all| istio| istio-all),?(s+|$)
      - agent: tekton
        alwaysRun: false
        context: istio-tls
        name: istio-tls
        queries:
          - labels:
              entries:
                - approved
                - lgtm
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
          - labels:
              entries:
                - updatebot
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
                - needs-security-review
        report: true
        rerunCommand: /test istio-tls
        trigger: (?m)^/test( all| istio-tls| istio-all),?(s+|$)
      - agent: tekton
        alwaysRun: false
        context: kube
        name: kube
        queries:
          - labels:
              entries:
                - approved
                - lgtm
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
          - labels:
              entries:
                - updatebot
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
                - needs-security-review
        report: true
        rerunCommand: /test kube
        trigger: (?m)^/test( all| kube),?(s+|$)
      - agent: tekton
        alwaysRun: false
        context: mc
        name: mc
        queries:
          - labels:
              entries:
                - approved
                - lgtm
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
          - labels:
              entries:
                - updatebot
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
                - needs-security-review
        report: true
        rerunCommand: /test mc
        trigger: (?m)^/test( all| mc),?(s+|$)
      - agent: tekton
        alwaysRun: false
        context: remote
        name: remote
        queries:
          - labels:
              entries:
                - approved
                - lgtm
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
          - labels:
              entries:
                - updatebot
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
                - needs-security-review
        report: true
        rerunCommand: /test mc
        trigger: (?m)^/test( all| mc),?(s+|$)
      - agent: tekton
        alwaysRun: false
        context: storage
        name: storage
        queries:
          - labels:
              entries:
                - approved
                - lgtm
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
          - labels:
              entries:
                - updatebot
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
                - needs-security-review
        report: true
        rerunCommand: /test storage
        trigger: (?m)^/test( all| storage),?(s+|$)
      - agent: tekton
        alwaysRun: false
        context: terraform
        name: terraform
        queries:
          - labels:
              entries:
                - approved
                - lgtm
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
          - labels:
              entries:
                - updatebot
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
                - needs-security-review
        report: true
        rerunCommand: /test terraform
        trigger: (?m)^/test( all| terraform),?(s+|$)
      - agent: tekton
        alwaysRun: true
        context: tls
        name: tls
        queries:
          - labels:
              entries:
                - approved
                - lgtm
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
          - labels:
              entries:
                - updatebot
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
                - needs-security-review
        report: true
        rerunCommand: /test tls
        trigger: (?m)^/test( all| tls),?(s+|$)
      - agent: tekton
        alwaysRun: false
        context: vault
        name: vault
        queries:
          - labels:
              entries:
                - approved
                - lgtm
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
          - labels:
              entries:
                - updatebot
            missingLabels:
              entries:
                - do-not-merge
                - do-not-merge/hold
                - do-not-merge/work-in-progress
                - needs-ok-to-test
                - needs-rebase
                - needs-security-review
        report: true
        rerunCommand: /test vault
        trigger: (?m)^/test( default| all| vault),?(s+|$)
    replace: true
